jQuery(function(t){function i(){o.find(".subscription_scheme").length>0?a.show():a.hide()}function n(){var t=o.find(".subscription_scheme");t.length>0&&t.wcsatt_init_type_dependent_inputs()}function e(){var i=t("select#product-type").val(),n=o.find(".subscription_scheme").length;"subscription"!==i&&"variable-subscription"!==i&&(n>0?t(".subscription_one_time_shipping").show():t(".subscription_one_time_shipping").hide())}function s(){o.find(".subscription_scheme").each(function(i,n){t(".position",n).val(parseInt(t(n).index(".subscription_schemes .subscription_scheme")))})}var c=t("#wcsatt_data"),o=c.find(".subscription_schemes"),a=c.find(".general_scheme_options"),r={message:null,overlayCSS:{background:""!==wcsatt_admin_params.post_id?"#fff":"#f1f1f1",opacity:.6}};t.fn.wcsatt_init_help_tips=function(){t(this).find(".help_tip, .tips, .woocommerce-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})},t.fn.wcsatt_init_type_dependent_inputs=function(){var i=t("select#product-type").val(),n="variable"===i?wcsatt_admin_params.i18n_override_option_variable:wcsatt_admin_params.i18n_override_option,e="variable"===i?wcsatt_admin_params.i18n_inherit_option_variable:wcsatt_admin_params.i18n_inherit_option,s="variable"===i?wcsatt_admin_params.i18n_discount_description_variable:wcsatt_admin_params.i18n_discount_description;t(this).find('.subscription_pricing_method_input [value="inherit"]').text(e),t(this).find('.subscription_pricing_method_input [value="override"]').text(n),t(this).find(".subscription_price_discount .woocommerce-help-tip").attr("data-tip",s).wcsatt_init_help_tips()},t.fn.wcsatt_refresh_scheme_lengths=function(){var i=t(this).find(".wc_input_subscription_length"),n=t(this).find(".wc_input_subscription_period"),e=t(this).find(".wc_input_subscription_period_interval"),s=i.val(),c=parseInt(e.val()),o=!1;i.empty(),t.each(wcsatt_admin_params.subscription_lengths[n.val()],function(n,e){0!=parseInt(n)&&0!=parseInt(n)%c||i.append(t("<option></option>").attr("value",n).text(e))}),i.children("option").each(function(){if(this.value==s)return o=!0,!1}),o?i.val(s):i.val(0)},""===wcsatt_admin_params.post_id&&(c.on("click","h3",function(){var i=t(this).closest(".wc-metabox"),n=i.find(".wc-metabox-content");i.hasClass("closed")?n.show():n.hide(),i.toggleClass("closed")}),c.find(".wc-metabox").each(function(){var i=t(this),n=i.find(".wc-metabox-content");i.hasClass("closed")&&n.hide()})),t.fn.wcsatt_refresh_sync_options=function(){var i=t(this).find(".wc_input_subscription_period"),n=t(this).find(".subscription_sync"),e=n.find(".subscription_sync_annual"),s=n.find(".subscription_sync_week_month"),c=s.find("select"),o=i.val();"day"===o?(n.hide(),c.val(0),e.find('input[type="number"]').val(0)):(n.show(),"year"===o?(s.hide(),e.find('input[type="number"]').val(0),c.val(0),e.show()):(e.hide(),e.find('input[type="number"]').val(0),c.empty(),t.each(WCSubscriptions.syncOptions[o],function(i,n){i||(n=wcsatt_admin_params.i18n_do_no_sync),c.append(t("<option></option>").attr("value",i).text(n))}),s.show()))},t("select#product-type").change(function(){n(),i(),e()}).change(),c.on("woocommerce_subscription_schemes_changed",function(){i(),e()}),o.on("change","select.subscription_pricing_method_input",function(){var i=t(this).val();t(this).closest(".subscription_scheme_product_data").find(".subscription_pricing_method").hide(),t(this).closest(".subscription_scheme_product_data").find(".subscription_pricing_method_"+i).show()}),c.find("input#_wcsatt_force_subscription").on("change",function(){t(this).is(":checked")?c.find(".wcsatt_default_status").hide():c.find(".wcsatt_default_status").show()}).change(),o.on("change",".wc_input_subscription_period",function(){t(this).closest(".subscription_scheme").wcsatt_refresh_scheme_lengths(),t(this).closest(".subscription_scheme").wcsatt_refresh_sync_options()}),c.on("click","span.scheme-remove",function(){var i=t(this).closest(".subscription_scheme");return i.find("*").off(),i.remove(),s(),c.trigger("woocommerce_subscription_schemes_changed"),!1}),c.on("click",".expand_all",function(){return o.find(".wc-metabox > .wc-metabox-content").show(),!1}),c.on("click",".close_all",function(){return o.find(".wc-metabox > .wc-metabox-content").hide(),!1});var _=c.find(".wc-metabox").length;c.on("click","button.add_subscription_scheme",function(){c.block(r),_++;var i={action:"wcsatt_add_subscription_scheme",post_id:wcsatt_admin_params.post_id,index:_,security:wcsatt_admin_params.add_subscription_scheme_nonce};return t.post(wcsatt_admin_params.wc_ajax_url,i,function(t){o.append(t.markup);var i=o.find(".subscription_scheme").last();i.wcsatt_init_type_dependent_inputs(),i.wcsatt_init_help_tips(),i.find("select.subscription_pricing_method_input").change(),s(),c.unblock(),c.trigger("woocommerce_subscription_scheme_added",t),c.trigger("woocommerce_subscription_schemes_changed")},"json"),!1}),function(){o.find("select.subscription_pricing_method_input").change();var i=o.find(".subscription_scheme").get();i.sort(function(i,n){var e=parseInt(t(i).attr("rel")),s=parseInt(t(n).attr("rel"));return e<s?-1:e>s?1:0}),t(i).each(function(t,i){o.append(i)}),o.sortable({items:".subscription_scheme",cursor:"move",axis:"y",handle:"span.scheme-handle",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(t,i){i.item.css("background-color","#f6f6f6")},stop:function(t,i){i.item.removeAttr("style"),s()}})}()});